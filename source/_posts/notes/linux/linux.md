---
title: Linux
date: 2021-02-02 16:50:30
categories:
  - 笔记
---

# 常用快捷键

| 按键          | 作用                                 |
| ------------- | ------------------------------------ |
| ctrl+d        | 键盘输入结束或退出终端               |
| ctrl+s        | 暂停当前程序                         |
| ctrl+z        | 当前程序放到后台运行，恢复到前台为fg |
| ctrl+a        | 将光标移到行头，相当于home           |
| ctrl+e        | 相当于end                            |
| ctrl+k        | 删除从光标到行末的内容               |
| alt+Backspace | 删除一个单词（不是字母）             |
| shift+PgUp    | 终端向上                             |
| shift+PgDn    | 终端向下                             |

# Shell中常用的通配符

| 字符           | 含义                             |
| -------------- | -------------------------------- |
| *              | 匹配0或多个字符                  |
| ？             | 匹配任意一个字符                 |
| [list]         | 匹配list中任意单一字符           |
| [^list]        | 匹配list之外的字符               |
| [c1-c2]        | 匹配c1到c2中任意单一字符如 [0-9] |
| {s1,s2,......} | 匹配其中一个字符串               |
| {c1..c2}       | 匹配全部字符                     |

# Linux的目录结构

- /bin

  Binary的缩写，存放着最经常使用的命令

- /sbin

  super bin， 存放系统管理员使用的系统管理程序

- /home

  存放普通用户的主目录，其中每个linux用户都有自己的一个目录，相当于win中的user

- /root

  系统管理员的用户主目录

- /boot

  存放启动linux时的核心文件

- /proc

  一个虚拟的目录，系统内存的映射

- srv

  存放一些服务启动后要提取的数据

- sys

  存放了一个文件系统

- tmp

  存放临时文件

- /dev

  相当于设备管理器，把所有的硬件以文件的形式存储

- /media

  linux自动识别一些设备，如U盘光驱等， 识别后会把识别的设备挂载到这个目录下

- /mnt

  系统提供该目录给用户临时挂在别的文件系统，用户可以将外部的存储挂载在/mnt/

- /opt

  给主机额外安装软件所用的目录

- /usr/local

  安装额外软件的目录，一般是通过编译源码安装的

- /var

  存放经常修改的目录，比如各种日志

- /selinux[security-enhanced linux] 360

  一种安全子系统，可以控制程序只能访问特定文件

# vim

## 模式

- esc -> 默认模式
- i|a -> 编辑模式
- :|/ -> 命令模式

## 常用快捷键

通常是指默认模式下

- v 选择模式

- 选择模式按下y复制
- 拷贝当前行 yy
- 粘贴 p
- 选择模式删除选中 d
- 删除当前行 dd
- 连续删除5行 5dd
- 查找 /关键字，光标会跳到查找位置，n为查找下一个
- 设置显示行号 :set nu 
- 设置取消行号 :set nonu 
- 最末行 G 第一行 gg

- 撤销一步 u
- 跳到第4行 默认模式 4 shift+g
- 设置编码 :set encoding=utf-8

# 关机/登录/注销

- sync 将内存中数据写入磁盘
- shutdown
  - -h now 立即关机
  - -h 1 1分钟后关机
  - -r now 立即重启
- halt 等价于关机
- reboot 重启
- logout 注销， 在图形界面无效

# 用户/用户组

## 相关操作

- useradd \<用户名\> 新增一个用户
- useradd -d 指定某目录 -g 指定组 \<用户名\> 
- passwd \<用户名\> 更改密码
- userdel \<用户名\> 删除用户
- userdel -r \<用户名\> 删除用户及其目录
- id  \<用户名\>  查询用户信息
- su -  \<用户名\>  切换用户
- su 切换到root
- exit 返回上一个用户
- groupadd  \<组名\> 添加组
- groupdel  \<组名\> 删除组
- usermod -g \<组名\>   \<用户名\>  切换一个用户到另一个组

## 几个点

- 从权限高的用户切换到权限低的用户不需要输入密码
- sudo \<cmd\> 可以以特权级别运行 cmd 命令， 需要当前用户属于 sudo 组，且需要输入当前用户的密码

- su - \<user\> 也可以切换当前用户到user，但同时用户的环境变量和工作目录也会随之改变

- groups \<用户名\> 查看该用户所在组

- groups 查看当前用户所在组

- adduser 和 useradd 的区别

  useradd 只创建用户，不会创建用户密码和工作目录， 创建完了要用passwd \<username\> 去设置用户密码

  adduser 在创建用户的同时会有创建密码和工作目录的步骤

  useradd类似命令，adduser 类似程序

- /etc/passwd 文件 存放用户的各种信息

  用户名:口令:用户标识号:组标识号:注释性描述:主目录:登录shell

- /etc/shadow 文件 存放口令配置

  登 录 名:加 密 口 令: 最 后 一 次 修 改 时 间:最 小 时间 隔:最 大 时 间 回 隔:警 告 时 间:不 活 动  时 间 :失 效 时 间:标 志

- /etc/group 文件 存放组信息

  组名:口令:组标识号:组内用户列表

# 运行级别

- 0：关机
- 1：单用户[找回丢失密码]
- 2：多用户状态没有网络服务
- 3：多用户状态有网络服务
- 4：系统未使用
- 5： 图形界面
- 6： 系统重启

常用级别为3和5

修改/etc/inittab 的id:5:initdefault: 这一行中的数字改变默认运行级别

## 单用户状态找回root密码

开机 > 引导时回车 > 输入 e > 选第二行编辑内核 > 输入e > 输入1回车 > 输入 b 此时进入单用户模式,可使用passwd修改root密码 > reboot 重启

# 帮助命令

- man  <命令> 
- help  <命令> 

# 文件操作

- pwd 显示当前工作目录的绝对路径
- ls  [option] [目录或者文件] 
  - -a 显示当前目录所有文件和目录，包括隐藏内容
  - -l 列表方式显示

- cd [参数] 进入目录

  - cd ~ 或者 cd : 

    进入用户目录

  - 当前路径 cd .
  - 上一级 cd ..
  - 绝对路径 cd /

- mkdir [option]  <目录名> 创建目录

  - -p 创建多级目录

- rmdir [option]  <目录名> 删除目录

  - -rf 删除非空目录

- touch  <文件名> 创建文件

- cp [option] \<源文件/目录\> \<目标目录/目标文件名\> 复制文件

  - -r 复制文件夹

  - 指定目标文件名会在复制的同时重命名

  - 强制覆盖 \\cp [option] \<源文件/目录\> \<目标目录/目标文件名\> 

  - scp 系统之间传输文件

    scp C:\Users\zbh\Desktop\1.txt  lucas@192.168.11.150:/home/lucas/

- rm [option]  <目录名/文件名> 删除
  - -r 删除文件夹
  - -f 强制删除不提示
  - 比如 rm -rf 

- mv \<源文件/目录\> \<目标目录/目标文件名\> 移动文件或者重命名

- cat [option]   输出文件内容
  - -n 显示行号
  - 一般搭配管道命令 |more 使用分页浏览
- more <文件名>
  - space 向下一页
  - enter 向下一行
  - q 退出
  - ctrl+f 向下一屏
  - ctrl+b 向上一屏
  - = 输出当前行行号
  - :f 输出文件名和当前行行号
- less <文件名> 类似more，但非一次性读出，适合大文件浏览
  - space 向下一页
  - pagedown 向下一页
  - pageup 向上一页
  - / 向下搜索 n 下一个 N 上一个
  - ? 向上搜索 n 上一个 N 下一个
  - q 退出

# 覆盖追加

- \> 将原来的内容覆盖
- \>\> 追加到文件尾部

例如：ls -l > a.txt 将ls -l 的显示内容覆盖到a.txt中， 如果文件不存在则创建

# echo

输出内容到控制台

echo $PATH 

# head&tail

- head 用于显示文件的开头部分内容
  - head \<文件名\> 查看文件前十行内容
  - head -n 5  \<文件名\> 查看前5行内容
- tail 显示文件尾部内容
  - tail  \<文件名\> 查看后十行
  - tail -n 5  \<文件名\> 查看后5行
  - tail -f  \<文件名\> 实时追踪更新

# 链接

## 链接的概念

类似于win中的快捷方式，但不大相同

- 硬链接 hard link

  与快捷方式不同的是，硬链接和源文件都是指向同一个文件，但是如果一个文件创建了硬链接，那即使将源文件删除， 也可以通过硬链接去访问。直到将所有的硬链接删除，才算删除彻底。

  这里有个概念为inode，每次增加一个硬链接，该文件的inode会加1，当删除文件直到inode为0时，才算彻底删除

  需要注意的是

  - 硬链接以副本的方式存在，但不占用实际空间
  - 不允许给目录创建硬链接
  - 硬链接只有在同一个文件系统中才能创建

- 软链接 又叫符号链接 symbolic link

  类似于快捷方式，源文件删除后，软链接也会失效

  - 以路径的形式存在
  - 可以跨文件系统
  - 可以对一个不存在的文件名链接
  - 可以对目录链接

## ln命令

ln命令用于创建链接文件

ln [option]  \<文件名\>

- -b 删除， 覆盖以前建立的链接
- -d 允许超级用户制作目录的硬链接
- -f 强制执行
- -i 交互模式， 文件存在则提示用户是否覆盖
- -n 把软链接视为一般目录
- -s 软链接（符号链接）
- -v 显示详细的处理过程

注意的是。如果删除软链接时，文件名末尾带斜杠，会显示资源忙

# history

用于查看最近的指令

!n 执行历史记录中编号为n的指令，!n之间无空格

# 时间日期

date 显示当前日期

- date +%Y 显示年份
- date +%m 显示月份
- date +%d 显示天
- date "+%Y年%m月%d日 %H点%M分%S秒" 连接符显示， 为了避免空格导致参数中断，可以加双引号
- date -s "2021-10-10 11:22:33" 设置当前时间

ntpdate -u ntp.api.bz 根据时间同步服务器同步时间

cal 查看日历（需要安装）

- cal 2018 查看2018年的全部日历

# 搜索

find [搜索范围] [option]  \<关键词\>

- -name 按照文件名 默认为该模式

  可使用通配符* 比如find -name \*ello\*

- -user 按照用户名

- -size 按照文件大小

  - find -size +20M 查找大于20M的文件
  - find -size 20M 查找等于20M的文件
  - find -size -20M 查找小于20M的文件

locate 在索引中查找，会快一点，但需要更新索引

grep [option] [文件名] \<关键词\>在文件中查找具体内容

- -n 显示行号
- -i 忽略大小写

# 压缩解压

## *.gz

gzip用于压缩文件，gunzip用于解压文件

gzip压缩之后不会保留源文件

## *.zip

zip用于压缩文件，unzip用于解压

zip  [option]  \<压缩后文件名\>  \<压缩文件名\>

- -r 递归压缩目录

unzip  [option]  \<解压文件名\>  

- -d \<目标目录文件名\>

## *.tar.gz

tar [option] \<压缩后文件名\>  \<压缩文件名\>

- -c 产生 *.tar 打包文件
- -v 显示详细信息
- -f 指定压缩后的文件名
- -z 打包的同时压缩
- -x 解包

示例：

- 压缩多个文件

  tar -zcvf a.tar.gz a.txt b.txt

- 解压到当前目录

  tar -zxvf a.tar.gz

- 解压到已存在目录

  tar -zxvf a.tar.gz -C /opt/

# 组管理和权限管理

#####

- df -lh 查询磁盘使用情况
- du -h <目录名> 查询指定目录的磁盘占用
  - -a 显示具体文件
  - -s 只显示整个目录占用大小，不可与a同时使用
  - -h 带计量单位
  - -c 列出明细增加汇总值
  - --max-depth=1 查询子目录深度

# 文件统计

通过搭配使用 ls ，grep，wc命令

- ls 文件信息
- grep 正则表达式的筛选
- wc 统计行数

例：

统计文件个数

​	ls -l |grep "^-" |wc -l

树状显示 tree

# 进程管理

分为前台进程和后台进程，且每个进程都会有一个父进程，父进程结束后子进程也会结束，比如ssh连接

- ps 查看进程
  - -e 显示所有进程
  - -f 全格式
- ctrl + c 终止前台进程
- kill [option] <进程号> 结束进程
  - -9 立刻停止
- pstree 进程数
  - -p 显示pid
  - -u 显示进程所属用户

- service [start|stop|restart|reload|status] <服务名> 服务管理

- top [option] 动态进程监控

  - -d <秒> 更新间隔
  - -l 不显示闲置或僵死进程
  - -p 指定进程pid

  运行后交互

  - P cpu排序
  - M 内存排序
  - N pid排序
  - q 退出
  - u 输入用户
  - k 杀死进程

# 网络

- netstat
  - -an 按一定顺序
  - -p 显示哪个进程在调用

