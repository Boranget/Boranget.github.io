---
title: encrypt
date: 2023-08-16 17:15:30
updated: 2023-08-17 10:35:19
tags:
  - 加密算法
categories:
  - 笔记
---

# AES加密

AES支持三种长度的密钥：128位、192位、256位，分别称之为AES128、AES192和AES256。

AES加密会把明文拆成一个一个的明文块，每个明文块128bit，如果最后一块长度不足128位，则默认使用缺失的字节数填充。接着对这些明文块分别加密，将加密结果拼接形成最终加密结果。

在加解密过程，每个明文块会作为4*4字节的矩阵进行处理

加密过程包括如下四步

- AddRoundKey（轮密钥加）

  矩阵中的每个字节都与该次轮密钥（round key）做异或运算

- SubBytes（字节替代）

  通过非线性的替换函数，用查找表的方式把每个字节替换成对应的字节

- ShiftRows（行移位）

  将矩阵中的每个横列进行循环式移位

- MixColumns（列混淆）

  为了充分混合矩阵中各个直行的操作，使用线性转换来混合每列的四个字节。

## 填充方式

- 不填充 NoPadding

  不进行填充，要求明文必须位16个字节的整数倍。

- 长度填充 PKCS5Padding（默认）

  填充的数据为16-最后一块字节数：相差长度

  若明文为16个字节的整数倍，则填充16个字节的数据，其值都为16（16-0）

  若明文非16字节整数倍，则最后一块肯定不足16个字节，此时将最后一块补齐为16字节，每个字节的值为相差长度

- 随机长度填充 ISO10126Padding

  与长度填充类似，不同之处在于相差长度只保存在最后一字节，其余字节使用随机数填充。

## 加密模式

- ECB（默认）

  电码本模式 Electronic Codebook Book

  根据密钥的位数，将明文分为不同块加密，加密结果拼接，缺点是如果明文块相同，那么密文块也相同。

- CBC

  密码分组链接模式 Cipher Block Chaining

  引入一个初始向量，使用该向量与第一块数据异或，接着加密作为第一块的加密结果；第二块数据使用第一块的加密结果进行异或，接着加密，以此类推。就算明文块相同，密文块也不会相同。缺点是加密无法并行。

- CFB

  密码反馈模式 Cipher FeedBack

- OFB

  输出反馈模式 Output FeedBack